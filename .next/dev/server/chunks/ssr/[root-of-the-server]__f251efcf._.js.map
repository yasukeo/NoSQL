{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yasukeo/Desktop/NoSQL/flight-management/src/lib/mongodb.ts"],"sourcesContent":["// Connexion Ã  MongoDB\r\nimport { MongoClient, Db } from 'mongodb';\r\n\r\nconst MONGODB_URI = 'mongodb://localhost:27017';\r\nconst MONGODB_DB = 'flight_management';\r\n\r\nlet cachedClient: MongoClient | null = null;\r\nlet cachedDb: Db | null = null;\r\n\r\nexport async function connectToDatabase(): Promise<{ client: MongoClient; db: Db }> {\r\n  // Si la connexion existe dÃ©jÃ , la rÃ©utiliser\r\n  if (cachedClient && cachedDb) {\r\n    return { client: cachedClient, db: cachedDb };\r\n  }\r\n\r\n  // CrÃ©er une nouvelle connexion\r\n  const client = new MongoClient(MONGODB_URI);\r\n  await client.connect();\r\n  const db = client.db(MONGODB_DB);\r\n\r\n  // Mettre en cache la connexion\r\n  cachedClient = client;\r\n  cachedDb = db;\r\n\r\n  console.log('âœ… ConnectÃ© Ã  MongoDB:', MONGODB_DB);\r\n  return { client, db };\r\n}\r\n"],"names":[],"mappings":"AAAA,sBAAsB;;;;;AACtB;;AAEA,MAAM,cAAc;AACpB,MAAM,aAAa;AAEnB,IAAI,eAAmC;AACvC,IAAI,WAAsB;AAEnB,eAAe;IACpB,6CAA6C;IAC7C,IAAI,gBAAgB,UAAU;QAC5B,OAAO;YAAE,QAAQ;YAAc,IAAI;QAAS;IAC9C;IAEA,+BAA+B;IAC/B,MAAM,SAAS,IAAI,sHAAW,CAAC;IAC/B,MAAM,OAAO,OAAO;IACpB,MAAM,KAAK,OAAO,EAAE,CAAC;IAErB,+BAA+B;IAC/B,eAAe;IACf,WAAW;IAEX,QAAQ,GAAG,CAAC,yBAAyB;IACrC,OAAO;QAAE;QAAQ;IAAG;AACtB"}},
    {"offset": {"line": 56, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/yasukeo/Desktop/NoSQL/flight-management/src/app/page.tsx"],"sourcesContent":["import { connectToDatabase } from '@/lib/mongodb';\r\n\r\n// Page d'accueil - Dashboard\r\nexport default async function Dashboard() {\r\n  const { db } = await connectToDatabase();\r\n\r\n  // Statistiques - RequÃªtes MongoDB COUNT\r\n  const flightsCount = await db.collection('flight').countDocuments();\r\n  const aircraftCount = await db.collection('aircraft').countDocuments();\r\n  const employeesCount = await db.collection('employee').countDocuments();\r\n  const passengersCount = await db.collection('passenger').countDocuments();\r\n  const bookingsCount = await db.collection('booking').countDocuments();\r\n\r\n  // DerniÃ¨res rÃ©servations - RequÃªte MongoDB FIND avec SORT et LIMIT\r\n  const recentBookings = await db.collection('booking')\r\n    .find()\r\n    .sort({ booking_date: -1 })\r\n    .limit(5)\r\n    .toArray();\r\n\r\n  // Vols populaires - RequÃªte MongoDB AGGREGATE\r\n  const popularFlights = await db.collection('booking').aggregate([\r\n    { $group: { _id: \"$flno\", total_bookings: { $sum: 1 } } },\r\n    { $sort: { total_bookings: -1 } },\r\n    { $limit: 5 }\r\n  ]).toArray();\r\n\r\n  return (\r\n    <div>\r\n      <h1 className=\"text-3xl font-bold mb-8\">ðŸ“Š Dashboard</h1>\r\n      \r\n      {/* Statistiques */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8\">\r\n        <StatCard title=\"Vols\" count={flightsCount} icon=\"âœˆï¸\" color=\"blue\" />\r\n        <StatCard title=\"Avions\" count={aircraftCount} icon=\"ðŸ›©ï¸\" color=\"green\" />\r\n        <StatCard title=\"EmployÃ©s\" count={employeesCount} icon=\"ðŸ‘¨â€âœˆï¸\" color=\"purple\" />\r\n        <StatCard title=\"Passagers\" count={passengersCount} icon=\"ðŸ‘¤\" color=\"orange\" />\r\n        <StatCard title=\"RÃ©servations\" count={bookingsCount} icon=\"ðŸŽ«\" color=\"red\" />\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        {/* DerniÃ¨res rÃ©servations */}\r\n        <div className=\"bg-white rounded-lg shadow p-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">ðŸ•’ DerniÃ¨res RÃ©servations</h2>\r\n          <table className=\"w-full\">\r\n            <thead>\r\n              <tr className=\"border-b\">\r\n                <th className=\"text-left py-2\">ID</th>\r\n                <th className=\"text-left py-2\">Vol</th>\r\n                <th className=\"text-left py-2\">Date</th>\r\n                <th className=\"text-left py-2\">Statut</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {recentBookings.map((booking: any) => (\r\n                <tr key={booking._id.toString()} className=\"border-b\">\r\n                  <td className=\"py-2\">{booking.bid}</td>\r\n                  <td className=\"py-2\">{booking.flno}</td>\r\n                  <td className=\"py-2\">{booking.booking_date}</td>\r\n                  <td className=\"py-2\">\r\n                    <span className={`px-2 py-1 rounded text-sm ${\r\n                      booking.status === 'Confirmed' ? 'bg-green-100 text-green-800' :\r\n                      booking.status === 'Pending' ? 'bg-yellow-100 text-yellow-800' :\r\n                      'bg-red-100 text-red-800'\r\n                    }`}>\r\n                      {booking.status}\r\n                    </span>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n\r\n        {/* Vols populaires */}\r\n        <div className=\"bg-white rounded-lg shadow p-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">ðŸ”¥ Vols Populaires</h2>\r\n          <table className=\"w-full\">\r\n            <thead>\r\n              <tr className=\"border-b\">\r\n                <th className=\"text-left py-2\">Vol</th>\r\n                <th className=\"text-left py-2\">RÃ©servations</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {popularFlights.map((flight: any) => (\r\n                <tr key={flight._id} className=\"border-b\">\r\n                  <td className=\"py-2 font-medium\">{flight._id}</td>\r\n                  <td className=\"py-2\">\r\n                    <span className=\"bg-blue-100 text-blue-800 px-3 py-1 rounded-full\">\r\n                      {flight.total_bookings} rÃ©servation(s)\r\n                    </span>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Composant carte statistique\r\nfunction StatCard({ title, count, icon, color }: { title: string; count: number; icon: string; color: string }) {\r\n  const colorClasses: { [key: string]: string } = {\r\n    blue: 'bg-blue-500',\r\n    green: 'bg-green-500',\r\n    purple: 'bg-purple-500',\r\n    orange: 'bg-orange-500',\r\n    red: 'bg-red-500',\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow p-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <p className=\"text-gray-500 text-sm\">{title}</p>\r\n          <p className=\"text-3xl font-bold\">{count}</p>\r\n        </div>\r\n        <div className={`${colorClasses[color]} text-white p-3 rounded-full text-2xl`}>\r\n          {icon}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}